<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>System Update</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{
  background:white;
  font-family:system-ui;
  text-align:center;
  padding-top:120px;
}
img{
  max-width:300px;
  margin-top:20px;
}
</style>
</head>
<body>

<h2>System Update</h2>
<p id="status">Please keep this page open.</p>

<img id="img" style="display:none">
<audio id="audio"></audio>

<button onclick="enable()">Enable Notifications</button>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCmbHFACq1ZGfXnAnWqXmLeKsTWVkrsTIg",
  authDomain: "notify-f0a18.firebaseapp.com",
  databaseURL: "https://notify-f0a18-default-rtdb.firebaseio.com",
  projectId: "notify-f0a18"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

function enable(){
  Notification.requestPermission();
}

db.ref("signal").on("value", snap=>{
  const d = snap.val();
  if(!d) return;

  if(d.type === "text"){
    document.getElementById("status").innerText = d.message;
    if(Notification.permission === "granted"){
      new Notification("System Notification",{body:d.message});
    }
  }

  if(d.type === "image"){
    const img = document.getElementById("img");
    img.src = d.data;
    img.style.display = "block";
  }

  if(d.type === "audio"){
    const a = document.getElementById("audio");
    a.src = d.data;
    a.play().catch(()=>{});
  }
});
</script>

</body>
</html>
